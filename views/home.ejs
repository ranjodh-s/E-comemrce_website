<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Home - Product List</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
 <%- include('partials/navbar') %>

<div class="container my-4">
  <% Object.keys(productsByCategory).forEach(category => { %>
    <div class="mb-5">
      <!-- Category Title -->
      <h4 class="mb-3">
        <a href="/category/<%= category %>" class="text-decoration-none text-dark">
          <%= category %>
        </a>
      </h4>

      <!-- Horizontal Scrollable Product List -->
      <div class="d-flex overflow-auto gap-3 pb-2">
        <% productsByCategory[category].forEach(product => { %>
          <div class="card" style="min-width: 200px;">
            <a href="/product/<%= product.id %>" class="text-decoration-none text-dark">
              <img src="<%= product.image_url %>" class="card-img-top" alt="<%= product.name %>" style="height: 150px; object-fit: cover;" onerror="this.src='https://placehold.co/200x150?text=No+Image';">
              <div class="card-body p-2">
                <h6 class="card-title mb-1"><%= product.name %></h6>
                <small class="text-muted"><%= product.brand %></small><br>
                <strong class="text-success">₹<%= product.price %></strong>
              </div>
            </a>
          </div>
        <% }) %>
      </div>
    </div>
  <% }) %>
</div>

  <script>
  async function addToCart(event, productId) {
    event.preventDefault();

    const res = await fetch('/cart/add', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({ product_id: productId })
    });

    const data = await res.json();
    if (data.success) {
      alert('✅ Item added to cart!');
    } else {
      alert('❌ Failed to add item.');
    }
  }
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>

</html>