<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Seller Dashboard</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css">
</head>
<body>
  <%- include('partials/seller-navbar.ejs') %>
  <div class="container mt-4">
  <h2 class="mb-2 text-center">ðŸ“Š Welcome, <%= seller.store_name %>!</h2>
  <h4 class="text-secondary mb-3">Your Product Sales Summary</h4>

  <% if (salesData.length === 0) { %>
    <div class="alert alert-info text-center">
      No sales data available yet.
    </div>
  <% } else { %>

    <% 
      let grandTotal = 0; 
      let totalQty = 0;
      salesData.forEach(product => { 
        grandTotal += Number(product.total_revenue);
        totalQty += Number(product.total_quantity_sold);
      });
    %>

    <!-- âœ… Total revenue summary section -->
    <div class="alert alert-success d-flex justify-content-between align-items-center p-3 fs-5">
      <div><strong>Total Quantity Sold:</strong> <span class="badge bg-primary fs-6"><%= totalQty %></span></div>
      <div><strong>Total Revenue:</strong> <span class="fw-bold text-dark">â‚¹<%= grandTotal %></span></div>
    </div>

    <!-- âœ… Table of products -->
    <table class="table table-bordered table-hover mt-3 align-middle">
      <thead class="table-dark">
        <tr>
          <th>Image</th>
          <th>Product ID</th>
          <th>Product Name</th>
          <th>Quantity Sold</th>
          <th>Total Revenue</th>
        </tr>
      </thead>
      <tbody>
        <% salesData.forEach(product => { %>
          <tr>
            <td style="width: 120px;">
              <img 
                src="<%= product.image_url ? product.image_url : 'https://placehold.co/100x100?text=No+Image' %>" 
                alt="<%= product.name %>" 
                style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px;">
            </td>
            <td><%= product.id %></td>
            <td><%= product.name %></td>
            <td><span class="badge bg-success"><%= product.total_quantity_sold %></span></td>
            <td class="fw-bold text-dark">â‚¹<%= product.total_revenue %></td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  <% } %>
</div>

</body>
</html>
